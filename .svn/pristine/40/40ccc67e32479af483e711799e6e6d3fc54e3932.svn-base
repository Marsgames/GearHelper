--local options = {
local slashCmd = {
    help = function(msg)
        print(cVert.."help --> affiche l'aide")
        print(cRouge.."state --> affiche l'état de l'addon")
        print(cJaune.."list --> scanBag() + scanCharacter()")
        print(cRose.."config --> affiche le panneau de config")
        print(cVert.."version --> affiche la version de l'addon")
        print(cRouge.."im msg --> change le message d'auto invite par msg")
        print(cJaune.."ram --> affiche la ram utilisée par l'addon")
        print(cRose.."createItemLink --> crée un faux itemLink (qui marche)")
        print(cJaune.."debug --> active / désactive le mode debug (prints)")
        print(cVert.."optimize --> calcul le stuff le plus opti ?")
        print(cRouge.."save --> crée un equipmentSet")
        print(cJaune.."equip --> équipe l'equipementSet précédement crée")
        print(cRose.."remove --> supprime l'equipmentSet précédement crée")
        print(cVert.."askloot --> active / désactive l'option pour annoncer les loots mieux que les notres en instance")
        print(cRouge.."dot --> affiche les icones des \"meilleurs items\" sur les icones des stuffs")
        print(cJaune.."suppdot --> supprime les icones de \"meilleurs item\" sur les icones des stuffs")
        print(cRose.."cw --> print la specID + la table contenant les custom weights")
        print(cVert.."eccip --> equip le meilleur stuff des sacs")
        print(cRouge.."ain --> test la fonction Ask If He Needs")
        print(cJaune.."reset --> reset GearHelper")
    end,
    state = function(msg)

    end,
    list = function(msg)
        GearHelper:scanBag()
        GearHelper:scanCharacter()
    end,
    config = function(msg)
        InterfaceOptionsFrame_OpenToCategory("GearHelper")
        InterfaceOptionsFrame_OpenToCategory("GearHelper")
    end,
    version = function(msg)
        print("|cFF00FF00GearHelper|r|cFFFFFF00 version : "..version)
    end,
    im = function(msg)
        setInviteMessage(tostring( msg:sub(4) ))
    end,
    ram = function(msg)
        local ramExact = tonumber(GetAddOnMemoryUsage("GearHelper"))
        local ramUse = tonumber(string.format("%.0f", ramExact))
        print("RAM used by GearHelper : "..ramUse.."ko")
    end,
    createitemlink = function(msg)
        --GearHelper:askIfHeNeed("Marsgames", "[Pierre de soin]", "Marsgames")
        local aze = "|cff1eff00|Hitem:128942::::::::100:105::::::|h[/gh createItemLink]|h|r"
        print(aze)
        print("test.isEquiped = "..tostring(test.isEquiped(aze)))
        print("test.isPossibleEquip = ".. tostring(test.isPossibleEquip(aze)))
        table.foreach(GearHelper:weightCalculation(aze), print)
    end,
    il = function(msg)
        local equiped = "|cff1eff00|Hitem:40018::::::::100:105::::::|h[Ulthalesh]|h|r"

        table.foreach(GearHelper:getStatsFromTooltip(equiped), print)

    end,
    debug = function(msg)
    end,
    stat = function(msg)

    end,
    optimize = function(msg)
        GearHelper:scanBag()
        GearHelper:scanCharacter()
        local tabEquipLoc = {}
        local tabItemMeta = {}
        local idItemTypeExist = 0
        for a = 1, #bagInventory do
            local _, itemLink, _, _, _, _, _, _, itemEquipLoc = GetItemInfo(bagInventory[a])
            local itemTypeExist = false

            for b = 0, #tabEquipLoc do
                if itemEquipLoc == tabEquipLoc[b] then
                    idItemTypeExist = b
                    itemTypeExist = true
                end
            end
            if itemTypeExist == false then
                table.insert(tabEquipLoc, itemEquipLoc)
                table.insert(tabEquipLoc, 1)
                local tabItem = {}

                table.insert(tabItem, itemLink)
                table.insert(tabItemMeta, itemEquipLoc)
                table.insert(tabItemMeta, tabItem)
            else
                tabEquipLoc[idItemTypeExist+1] = tabEquipLoc[idItemTypeExist+1] + 1
                local tmpTab = tabItemMeta[idItemTypeExist+1]
                table.insert(tmpTab, itemLink)
                tabItemMeta[idItemTypeExist+1] = tmpTab
            end
        end

        for a = 1, #tabItemMeta do
            if a%2 == 0 then
                local v = tabItemMeta[a]
                for b = 1, #v do
                    print(v[b])
                end
            else
                print(tabItemMeta[a])
            end
        end
        local stuffBefore = GearHelper.charInventory
        --SaveEquipmentSet("zeubi", 1029009)
        --print(GetEquipmentSetInfoByName("zeubzeub"))

        for a = 1, #bagInventory do
            local _, _, _, _, _, _, _, _, itemEquipLoc = GetItemInfo(bagInventory[a])
            if itemEquipLoc ~= "INVTYPE_WEAPON" and itemEquipLoc ~= "INVTYPE_2HWEAPON" and itemEquipLoc ~= "INVTYPE_FINGER" and itemEquipLoc ~= "INVTYPE_TRINKET" then
                print("On test "..bagInventory[a])

                local exItem = stuffBefore[GearHelper.itemSlot[itemEquipLoc]]
                local _, _, Color, Ltype, Id, Enchant, Gem1, Gem2, Gem3, Gem4, Suffix, Unique, LinkLvl, Name = string.find(exItem,"|?c?f?f?(%x*)|?H?([^:]*):?(%d+):?(%d*):?(%d*):?(%d*):?(%d*):?(%d*):?(%-?%d*):?(%-?%d*):?(%d*):?(%d*):?(%-?%d*)|?h?%[?([^%[%]]*)%]?|?h?|?r?")
                --EquipItemByName(bagInventory[a])
                --[[print(GetCombatRating(11)) --Critique
                print(GetCombatRating(17)) --Ponction
                print(GetCombatRating(20)) --Hate
                print(GetCombatRating(26)) --Maitrise
                print(GetCombatRating(29)) --Polyvalence
                print(GetCombatRating(21)) --Evitement]]--
                print("On replace "..exItem)
                --EquipItemByName(Id)
            end
        end
        waitEquipTimer = time()
        waitEquipFrame:Show()
    end,
    save = function(msg)
        SaveEquipmentSet("GHEquip", 769) -- Saves the currently equipped items in a set.
    end,
    equip = function(msg)
        UseEquipmentSet("GHEquip") -- Equips an equipment set.
    end,
    remove = function(msg)
        DeleteEquipmentSet("GHEquip") -- Forgets an equipment set.
    end,
    askloot = function(msg)
        if GearHelper.db.profile.askLootRaid == true then
            setGHAskLootRaid(false)
        else
            setGHAskLootRaid(true)
        end
    end,
    dot = function(msg)
        -- for bag = 0,4 do
        --     for slot = 1,GetContainerNumSlots(bag) do
        --         local itemLink = GetContainerItemLink(bag, slot)
        --         if itemLink ~= nil then
        --             local weightCalcResult = GearHelper:weightCalculation(itemLink)
        --             if weightCalcResult ~= nil then
        --                 if weightCalcResult[1] ~= nil and weightCalcResult[1] > 0 or weightCalcResult[2] ~= nil and weightCalcResult[2] > 0 then
        --GearHelper:suppDot()
        poseDot()
        --                 end
        --             end
        --         end
        --     end
        -- end
    end,
    suppdot = function(msg)
        GearHelper:suppDot()
        print("supp")
    end,
    cw = function(msg)
        print(specID)
    end,
    eccip = function(msg)
        waitEquipTimer = time()
        waitEquipFrame:Show()
    end,
    ain = function()
        GearHelper:createLinkAskIfHeNeeds(1)
    end,
    reset = function(msg)

        setDefault()
    end,
    aze = function(msg)
        GearHelper:createLinkAskIfHeNeeds(1)

        local used = false
        for i = 1, NUM_CHAT_WINDOWS do
            local name, fontSize, r, g, b, alpha, shown, locked, docked, uninteractable = GetChatWindowInfo(i);
            if(uninteractable) then
                SetChatWindowUninteractable(i, false)
                used = true
            end
        end
        if used then
            ReloadUI()
        end
    end,
    reload = function(msg)
        ReloadUI()
    end,
    testdelta = function(msg)
        local aze = {}
        local testA
        local equiped = "|cff1eff00|Hitem:128942::::::::100:105::::::|h[Ulthalesh]|h|r"
        local looted = "|cff1eff00|Hitem:71086::::::::100:105::::::|h[Tarecogosa]|h|r"

        aze = GetItemStatDelta(looted, equiped, testA)

        local tab = {}
        tab = GearHelper:getStatsDeltaFromTooltip(looted, equiped)
        table.foreach(tab, print)
        print("++++++++++++++++++++")
        table.foreach(aze, print)
        print("--------------------")
    end,
    jb = function(msg)
        local itemLink = GetContainerItemLink(1, 14)
        --print(itemLink)
        local aze = GearHelper:weightCalculation(itemLink)

        table.foreach(aze, print)
    end,
    feet = function(msg)
        --local _, equipedItem, itemEquipRarity = GetItemInfo(tostring(GearHelper.charInventory[GearHelper.itemSlot[itemLootEquipLoc]]))
        local _, equipedItem, itemEquipRarity = GetItemInfo(132455)
        print(equipedItem)
    end,
    printTable = function(msg)
        foreach(waitingIDTable, print)
        print("---")
    end,
}

GearHelper:RegisterChatCommand("GearHelper", "MySlashCommand")
GearHelper:RegisterChatCommand("GH", "MySlashCommand")

function GearHelper:MySlashCommand(input)
    for cmd, action in pairs(slashCmd) do
        if input == cmd then
            action()
            do return end
        end
    end

    if input == "" then
        InterfaceOptionsFrame:Show()
        InterfaceOptionsFrame_OpenToCategory(GearHelper.optionsFrame)
    else
        slashCmd["help"]()
    end

end
